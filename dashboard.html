<!DOCTYPE html>
<html lang="pt-PT">
<head>
<meta charset="UTF-8">
<title>Hayes Auto - Painel</title>
<style>
body{margin:0; font-family:Arial; background:#111; color:white;}
nav{background:#000; padding:18px; display:flex; justify-content:center; gap:50px;}
nav a{color:white; text-decoration:none; font-weight:bold; cursor:pointer;}
nav a:hover{color:#2563eb;}
.tab{display:none; padding:50px; text-align:center;}
.tab.active{display:block;}
.logout{position:absolute; top:15px; right:20px; background:#2563eb; padding:8px 15px; border-radius:6px; cursor:pointer;}
.user-item{margin:8px 0; background:#222; padding:10px; border-radius:6px; display:flex; justify-content:space-between; align-items:center;}
.user-item button{background:red; border:none; color:white; padding:5px 10px; border-radius:5px; cursor:pointer;}
</style>
</head>
<body>

<div class="logout" onclick="logout()">Sair</div>

<nav>
  <a onclick="showTab('inicio')">InÃ­cio</a>
  <a onclick="showTab('servicos')">ServiÃ§os</a>
  <a onclick="showTab('stock')">Stock</a>
  <a id="bossTab" onclick="showTab('boss')">Boss</a>
</nav>

<div id="inicio" class="tab active">
  <h1>Bem-vindo Ã  Hayes Auto ðŸš—</h1>
</div>

<div id="servicos" class="tab"><h1>ServiÃ§os</h1></div>
<div id="stock" class="tab"><h1>Stock</h1></div>

<div id="boss" class="tab">
  <h1>Painel do Boss ðŸ‘‘</h1>
  <h3>Criar Novo Utilizador</h3>
  <input id="newUser" placeholder="Nome do utilizador">
  <input id="newPass" placeholder="Senha">
  <select id="newRole">
    <option value="staff">MecÃ¢nico</option>
    <option value="admin">PatrÃ£o</option>
  </select>
  <button onclick="createUser()">Criar Conta</button>

  <h3 style="margin-top:40px;">Utilizadores Existentes</h3>
  <div id="userList"></div>
</div>

<script>
const USERS_JSON_URL = "https://gist.githubusercontent.com/Nandes04/a3a5e179305d5764ad9a563415a60d2f/raw/6fd2ee38523b441a323aff965829d463177d1d73/users.json";

if(!localStorage.getItem("user")) window.location.href = "index.html";
if(localStorage.getItem("role") !== "admin") document.getElementById("bossTab").style.display = "none";

function showTab(tabId){
    document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
    document.getElementById(tabId).classList.add("active");
}

function logout(){
    localStorage.clear();
    window.location.href="index.html";
}

let users = []; // lista local
async function loadUsers(){
    try{
        const res = await fetch(USERS_JSON_URL);
        users = await res.json();
        renderUsers();
    }catch(err){ alert("Erro ao carregar utilizadores: "+err.message);}
}

function renderUsers(){
    const container = document.getElementById("userList");
    container.innerHTML = "";
    users.forEach(u=>{
        container.innerHTML += `
        <div class="user-item">
            <span>${u.user} (${u.role})</span>
        </div>`;
    });
}

function createUser(){
    const u = document.getElementById("newUser").value.trim();
    const p = document.getElementById("newPass").value.trim();
    const r = document.getElementById("newRole").value;
    if(!u || !p){ alert("Preenche todos os campos"); return;}
    if(users.find(x=>x.user===u)){ alert("Utilizador jÃ¡ existe"); return;}
    users.push({user:u, pass:p, role:r});
    renderUsers();
    alert("Conta criada âœ…\nAgora precisas de atualizar o JSON online manualmente com esta nova conta.");
    document.getElementById("newUser").value="";
    document.getElementById("newPass").value="";
}

loadUsers();
</script>
</body>
</html>
